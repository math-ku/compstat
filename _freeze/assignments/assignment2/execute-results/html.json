{
  "hash": "0e6e67761bd3ec59080a21590d30fe20",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: Assignment 2\nsubtitle: Univariate Simulation\nimage: ../assets/images/assignment2.svg\ndescription:\n  Implement and compare rejection sampling and importance sampling algorithms\n  for specific probability distributions.\n---\n\n\n\nThe second assignment topic is univariate simulation. If you draw the topic\n\"Univariate Simulation\" at the oral exam, you will have to present a solution of\none of the two assignments below.\n\nRemember the five points:\n\n- How can you test that your implementation is correct?\n- Can you implement alternative solutions?\n- Can the code be restructured e.g. by modularization, abstraction or object\n  oriented programming to improve readability?\n- How does the implementation perform (benchmarking)?\n- Where are the bottlenecks (profiling), and what can you do about them?\n\nWhen comparing simulation algorithms it may be necessary to use the same pseudo\nrandom numbers (set the seed) or to compute results of comparable accuracy as\nmeasured by e.g. the standard error.\n\nBoth of the two simulation assignments are made very concrete. You can solve the\nassignments by writing code that is very specific, and this is a good way to get\nstarted. But you should (re)write the final solution to be more generic.\n\n# A: Rejection Sampling\n\nThis assignment uses the Poisson data available from [here](data/poisson.csv).\nIt is a table with 100 rows and two variables, $z$ and $x$, where $z$ takes\ninteger values and $x$ takes positive real values.\n\nThe purpose of this assignment is to sample from the probability distribution on\n$[0, \\infty)$ with density\n$$f(y) \\propto \\prod_{i=1}^{100}  \\exp\\left(yz_ix_i - e^{yx_i}\\right), \\quad y \\geq 0.$$\nFind a Gaussian envelope of $f$ and implement rejection sampling from the\ndistribution with density $f$ using this envelope.\n\nImplement the adaptive rejection sampling algorithm that uses a piecewise\nlog-affine envelope and compare it with the one based on the Gaussian envelope.\n\nYou are welcome to invent other envelopes and try to optimize the choice of\nenvelope. However, for the exam the focus should be on the implementations and\ntheir comparisons and not on theoretical derivations of envelopes.\n\n_For those interested, the distribution given by $f$ above is a simple example\nof a Bayesian posterior distribution in a Poisson regression model._\n\n# B: Importance Sampling\n\nLet $X_1, X_2, \\ldots$ be i.i.d. uniformly distributed on $(-1.9, 2)$ and define\n$$S_n = 30 + \\sum_{k=1}^n X_k.$$ Think of $X_k$ as the capital that a company or\na gambler earns or loses at time $n$. Starting with a total capital of 30, $S_n$\nis the total capital at time $n$. We are interested in computing the _ruin\nprobabilities_ before time $n$: $$p(n) = P(\\exists k \\leq n: S_k \\leq 0).$$\n\nImplement Monte Carlo integration to compute $p(100)$.\n\nDefine\n$$g_{\\theta, n}(x) = \\frac{1}{\\varphi(\\theta)^n} \\exp\\left(\\theta \\sum_{k=1}^n x_k\\right)$$\nfor $x \\in (-1.9, 2)^n$ where\n$$\\varphi(\\theta) = \\int_{-1.9}^2 e^{\\theta z} \\mathrm{d}z.$$ Implement\nimportance sampling to compute $p(100)$ by sampling from $g_{\\theta, 100}$ for\nsuitable $\\theta$. Is there an optimal choice of $\\theta$?\n\n_Note that you should consider number of samples as well as run time to discuss\nwhat \"optimal\" means._\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}